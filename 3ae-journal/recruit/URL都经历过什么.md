# URL都经历了些什么

## 一、访问主机

1. 先去DNS服务器去把域名转换成IP地址
2. 使用IP地址去访问目标主机
3. 如果该主机没有启动对外的服务(默认访问80端口)，则返回无法访问目标主机

## 二、前端代理（假设该IP的主机启动了最复杂的网络架构）

该IP地址的主机配置了nginx服务器进行端口映射虚拟主机、或进行了反向代理。

```utf-8
   同一局域网内不同子网段下启动了多台主机来执行相同的程序（负载均衡），不同的程序(PC端，WAP端)，通过轮询算法把大量请求平均分配在这些主机上。
   eg: 192.168.0.1:80 (外网默认访问主机)作为网关服务，把外网请求平均转发到下面三个IP主机
       192.168.0.51:8080 负载服务器    PC
       192.168.0.52:8080 负载服务器    PC
       192.168.0.91:8080 负载服务器    WAP
       192.168.0.92:8080 负载服务器    WAP
```

先把静态资源返回给用户，接着通过主机IP地址+端口号去访问后台服务获取API数据，最后在客户端拼装视图模型来给用户展示网站内容。

* 触发前端交互事件后需同时发送两个请求：一个GET请求获取静态资源(同时伪装URL),一个POST请求发送token验证并获取真实数据资源。

## 三、后端代理

配置了网关服务器配置，例如SpringCloud的Zuul，使用了RESTful架构进行了反向代理。

```utf-8
   同一局域网内不同子网段下启动了多台主机来执行相同的程序(负载均衡)，不同的程序(微服务)，通过轮询算法把大量请求平均分配在这些主机上。
   eg: 192.168.1.1:80 (外网默认访问主机)作为网关服务，把外网请求平均转发到下面三个IP主机
       192.168.1.11:8080 负载服务器    商品微服务
       192.168.1.12:8080 负载服务器    商品微服务
       192.168.1.21:8080 负载服务器    订单微服务
       192.168.1.22:8080 负载服务器    订单微服务
       192.168.1.31:8080 负载服务器    用户微服务
       192.168.1.32:8080 负载服务器    用户微服务
```

先把redis缓存服务器里的数据封装成视图Json对象返回给客户端，如果没有缓存则访问数据库。最后生成Json的API去给前端调用。