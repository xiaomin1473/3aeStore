<!DOCTYPE html>
<html lang="zh-CN">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

      <meta name="Keywords" content="爱悦购商城,爱悦购平台,爱悦购电子商务（北京）有限公司,跨境电商">
      <meta name="Description" content="爱悦购商城,爱悦购平台,跨境电商,爱悦购电子商务（北京）有限公司通过大数据、大物流、全交通以及全产业链等跨界联合，以“产品、服务、爱”为核心，致力于为消费者提供质优的商品、极致的服务、有担当的爱，同时推出“跨界联合”、“购爱”“正品行货”、“TO一站享 购”等多项专业服务。">

      <title>睿实</title>
      <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
      <link rel="shortcut icon" href="./assets/img/favicon.ico" />
      
      <link rel="stylesheet" href="./assets/css/common.css">
      <link rel="stylesheet" href="./assets/css/global.css">
      <link rel="stylesheet" href="./assets/css/login.css">
      
      <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
      <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->

      <!--[if lt IE 9]>
            <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
            <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->

   </head>
   <body>
      <div class="container">
         <form class="form" id="form">
            <div class="form-wrapper">
               <div class="form-header">
                  <h3>欢迎登录</h3>
               </div>
               <div class="form-body">
                  <div class="form-items">
                     <label class="label" for="">用户名：</label><input class="input-default" type="text" placeholder="用户名"><i></i><br>
                     <span class="tips"></span>
                  </div>
                  <div class="form-items">
                     <label class="label" for="">密  码：</label><input class="input-default" type="password" placeholder="密码"><i></i><br>
                     <span class="tips" id="message"></span>
                  </div>
               </div>
               <div class="form-footer">
                  <button class="btn-default" id="submit" type="button">登录</button>
                  <button class="btn-default" type="reset">重置</button>
               </div>
            </div>
         </form>

         <div class="alert">
            <div class="alert-header">
               <h3>使用说明</h3>
            </div>
            <div class="alert-body">
               <h4>
                  报表用途：用于公司的费用支出上报 登记 统计 （ERP系统 费用设定 未投入使用前为主）
               </h4>
               <h4>
                  适应业务范围：适用于运营中心、营销中心、制造中心、研发中心等
               </h4>
               <h4>
                  适应公司人员： 各 中心费用报销人员、财务部费用审核、费用支付 、各中心负责人 等
               </h4>
               <h4>
                  注意事项: 未经协商一致，不得更改表格格式（行 列 单元格）
               </h4>
            </div>
            <div class="alert-footer">
               <button id="closeAlert" type="submit">关闭</button>
            </div>
         </div>
      </div>
   </body>
</html>
<script src="./assets/js/ae.js"></script>
<script>

   
   var submit = document.getElementById('submit');
   var callback;
   var closeAlert = document.getElementById('closeAlert');

   closeAlert.addEventListener("click", function(){ 
      var alert = document.getElementsByClassName('alert')[0];
      console.log(alert)
      alert.style.display = 'none';
   })

   
   submit.addEventListener("click", function(){
      var msg = document.getElementById('message');
      var input = document.getElementsByTagName('input');

      if(!input[0].value || !input[1].value) {
         msg.innerHTML = "用户名密码不能为空"
         return;
      }

      var userName = input[0].value;
      var userPwd = input[1].value;
      var form = document.getElementById('form');
      var context = `userName=${userName}&userPwd=${userPwd}` 

      Ae.trans.AJAX({
         type: "POST",
         url: "/user/login",
         async: true,
         context: context,
         contentType: "application/x-www-form-urlencoded"
      }, callback)

      function callback(xmls) {
         jsonName = xmls.responseText;
         jsonName = JSON.parse(jsonName);
         console.log(jsonName);
         if(jsonName.success) {
            
            window.location.href='/';

            var Days = 30;
            var exp = new Date();
            exp.setTime(exp.getTime() + Days*24*60*60*1000);
            document.cookie = "Token" + "="+ escape (jsonName.data.token) + ";expires=" + exp.toGMTString();
            document.cookie = "UserName" + "="+ escape (jsonName.data.userName) + ";expires=" + exp.toGMTString();
            document.cookie = "UserPermit" + "="+ escape (jsonName.data.userPermit) + ";expires=" + exp.toGMTString();
         } else {
            msg.innerHTML = jsonName.error;
         }
      }
   });

   
   

</script>